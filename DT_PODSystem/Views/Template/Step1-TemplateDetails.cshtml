@model DT_PODSystem.Models.ViewModels.Step1TemplateDetailsViewModel

<div class="row">
    <div class="col-lg-8">
        <!-- Template Configuration Form -->
        <div class="panel panel-inverse">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <i class="fa fa-cog me-2"></i>Template Configuration
                </h4>
            </div>
            <div class="panel-body">
                <form id="step1-form">
                    @Html.AntiForgeryToken()

                    <!-- POD Selection - CRITICAL for template creation -->
                    <div class="form-section">
                        <h5><i class="fa fa-folder me-2"></i>Parent POD Selection</h5>
                        <p class="text-muted small mb-3">
                            Templates must belong to a POD (Point of Data). Select the POD that will own this template.
                        </p>

                        <div class="row">
                            <div class="col-md-12">
                                <div class="mb-3">
                                    <label for="pod-id" class="form-label required">Parent POD</label>
                                    <select id="pod-id" name="PODId" class="form-control" asp-for="PODId" required>
                                        <option value="">Search and select a POD</option>
                                        @foreach (var pod in Model.PODs)
                                        {
                                            <option value="@pod.Value" selected="@(pod.Value == Model.PODId.ToString())">
                                                @pod.Text
                                            </option>
                                        }
                                    </select>
                                    <span asp-validation-for="PODId" class="text-danger"></span>
                                    <small class="form-text text-muted">
                                        The template will inherit settings from the selected POD
                                    </small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Template Technical Details -->
                    <div class="form-section">
                        <h5><i class="fa fa-file-alt me-2"></i>Template Details</h5>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="template-name" class="form-label required">Template Title</label>
                                    <input type="text" id="template-name" name="Name" class="form-control"
                                           asp-for="Name" placeholder="Enter template name"
                                           maxlength="200" required />
                                    <span asp-validation-for="Name" class="text-danger"></span>
                                    <small class="form-text text-muted">Descriptive name for the template</small>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="naming-convention" class="form-label required">File Prefix Name</label>
                                    <input type="text" id="naming-convention" name="NamingConvention" class="form-control"
                                           asp-for="NamingConvention" placeholder="DOC_POD"
                                           maxlength="100" required />
                                    <span asp-validation-for="NamingConvention" class="text-danger"></span>
                                    <small class="form-text text-muted">File prefix Name</small>
                                </div>
                            </div>
                        </div>
 
                    </div>

                    <!-- Processing Configuration -->
                    <div class="form-section">
                        <h5><i class="fa fa-settings me-2"></i>Processing Configuration</h5>

                        <div class="row">
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="processing-priority" class="form-label">Processing Priority</label>
                                    <select id="processing-priority" name="ProcessingPriority" class="form-control" asp-for="ProcessingPriority">
                                        <option value="1">1 - Critical</option>
                                        <option value="2">2 - High</option>
                                        <option value="3">3 - High</option>
                                        <option value="4">4 - Medium-High</option>
                                        <option value="5" selected>5 - Medium</option>
                                        <option value="6">6 - Medium</option>
                                        <option value="7">7 - Medium-Low</option>
                                        <option value="8">8 - Low</option>
                                        <option value="9">9 - Low</option>
                                        <option value="10">10 - Very Low</option>
                                    </select>
                                    <small class="form-text text-muted">Processing queue priority (1 = highest)</small>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="version" class="form-label">Version</label>
                                    <input type="text" id="version" name="Version" class="form-control"
                                           asp-for="Version" value="1.0" maxlength="10" />
                                    <small class="form-text text-muted">Template version number</small>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="mb-3">
                                    <div class="form-check mt-4">
                                        <input type="checkbox" id="has-form-fields" name="HasFormFields"
                                               class="form-check-input" asp-for="HasFormFields" />
                                        <label class="form-check-label" for="has-form-fields">
                                            <strong>Has Form Fields</strong>
                                            <br>
                                            <small class="text-muted">PDF contains interactive form fields</small>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-12">
                                <div class="mb-3">
                                    <label for="technical-notes" class="form-label">Technical Notes</label>
                                    <textarea id="technical-notes" name="TechnicalNotes" class="form-control"
                                              asp-for="TechnicalNotes" rows="2" maxlength="500"
                                              placeholder="Optional technical notes for developers"></textarea>
                                    <span asp-validation-for="TechnicalNotes" class="text-danger"></span>
                                </div>
                            </div>
                        </div>
                    </div>

                </form>
            </div>
        </div>
    </div>

    <div class="col-lg-4">
        <!-- Template Preview -->
        <div class="panel panel-inverse">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <i class="fa fa-eye me-2"></i>Template Preview
                </h4>
            </div>
            <div class="panel-body">
                <div class="template-preview">
                    <div class="mb-3">
                        <strong>Parent POD:</strong><br>
                        <span id="preview-pod" class="text-primary">
                            @(Model.PODs?.FirstOrDefault(p => p.Value == Model.PODId.ToString())?.Text ?? "Not Selected")
                        </span>
                    </div>

                    <div class="mb-3">
                        <strong>Template Name:</strong><br>
                        <span id="preview-name" class="text-primary">
                            @(string.IsNullOrEmpty(Model.Name) ? "Template Name" : Model.Name)
                        </span>
                    </div>

                    <div class="mb-3">
                        <strong>File Naming Pattern:</strong><br>
                        <code id="preview-convention">DOC_POD_202501_001.pdf</code>
                    </div>

                    <div class="mb-3">
                        <strong>Description:</strong><br>
                        <span id="preview-description" class="text-muted">
                            @(string.IsNullOrEmpty(Model.Description) ? "No description provided" : Model.Description)
                        </span>
                    </div>

                    <div class="mb-3">
                        <strong>Priority:</strong><br>
                        <span id="preview-priority" class="badge bg-info">Medium</span>
                    </div>

                    <div class="mb-3">
                        <strong>Version:</strong><br>
                        <span id="preview-version" class="text-muted">
                            @(string.IsNullOrEmpty(Model.Version) ? "1.0" : Model.Version)
                        </span>
                    </div>

                    <div class="mb-3">
                        <strong>Form Fields:</strong><br>
                        <span id="preview-form-fields" class="text-muted">
                            @(Model.HasFormFields ? "Yes" : "No")
                        </span>
                    </div>

                    <div class="mb-3">
                        <strong>Status:</strong><br>
                        <span class="badge bg-warning">Draft</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Validation Status -->
        <div class="panel panel-inverse">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <i class="fa fa-check-circle me-2"></i>Validation Status
                </h4>
            </div>
            <div class="panel-body">
                <div id="validation-status">
                    <div class="validation-item" data-field="pod">
                        <i class="fa fa-circle text-muted me-2"></i>Parent POD Selection
                    </div>
                    <div class="validation-item" data-field="name">
                        <i class="fa fa-circle text-muted me-2"></i>Template Name
                    </div>
                    <div class="validation-item" data-field="convention">
                        <i class="fa fa-circle text-muted me-2"></i>Naming Convention
                    </div>
                </div>

                <div class="mt-3">
                    <small class="text-muted">
                        <i class="fa fa-info-circle me-1"></i>
                        Complete all required fields to proceed to Step 2
                    </small>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .form-section {
        margin-bottom: 2rem;
        padding-bottom: 1.5rem;
        border-bottom: 1px solid #eee;
    }

        .form-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        .form-section h5 {
            color: #4F008C;
            margin-bottom: 1rem;
        }

    .required::after {
        content: " *";
        color: #dc3545;
    }

    .validation-item {
        padding: 0.25rem 0;
    }

    .template-preview {
        font-size: 0.9rem;
    }

        .template-preview strong {
            color: #333;
        }

    #preview-convention {
        background-color: #f8f9fa;
        padding: 0.25rem 0.5rem;
        border-radius: 0.25rem;
        font-family: 'Courier New', monospace;
    }
</style>